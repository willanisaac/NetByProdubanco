<div class="modal-overlay" (click)="closeModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ isEditMode ? 'Editar Producto' : 'Nuevo Producto' }}</h2>
      <button class="close-btn" (click)="closeModal()">×</button>
    </div>
    
    <form (ngSubmit)="onSubmit()" #productForm="ngForm" class="modal-body">
      <div class="form-group">
        <label for="name" class="form-label">Nombre del Producto *</label>
        <input
          type="text"
          id="name"
          name="name"
          [(ngModel)]="formData.name"
          class="form-input"
          placeholder="Ingresa el nombre del producto"
          required
          #nameInput="ngModel"
        >
        <div *ngIf="nameInput.invalid && nameInput.touched" class="error-message">
          El nombre del producto es requerido
        </div>
      </div>
      
      <div class="form-group">
        <label for="description" class="form-label">Descripción *</label>
        <textarea
          id="description"
          name="description"
          [(ngModel)]="formData.description"
          class="form-textarea"
          placeholder="Describe el producto"
          required
          rows="3"
          #descriptionInput="ngModel"
        ></textarea>
        <div *ngIf="descriptionInput.invalid && descriptionInput.touched" class="error-message">
          La descripción es requerida
        </div>
      </div>
      
      <div class="form-group">
        <label for="category" class="form-label">Categoría *</label>
        <select
          id="category"
          name="category"
          [(ngModel)]="formData.category"
          class="form-select"
          required
          #categoryInput="ngModel"
        >
          <option value="">Selecciona una categoría</option>
          <option *ngFor="let category of categories" [value]="category.name">
            {{ category.name }}
          </option>
        </select>
        <div *ngIf="categoryInput.invalid && categoryInput.touched" class="error-message">
          La categoría es requerida
        </div>
      </div>
      
      <div class="form-group">
        <label for="imageUrl" class="form-label">URL de Imagen</label>
        <input
          type="url"
          id="imageUrl"
          name="imageUrl"
          [(ngModel)]="formData.imageUrl"
          class="form-input"
          placeholder="https://ejemplo.com/imagen.jpg"
          #imageUrlInput="ngModel"
        >
        <div *ngIf="imageUrlInput.invalid && imageUrlInput.touched" class="error-message">
          Ingresa una URL válida
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="price" class="form-label">Precio *</label>
          <input
            type="number"
            id="price"
            name="price"
            [(ngModel)]="formData.price"
            class="form-input"
            placeholder="0.00"
            min="0"
            step="0.01"
            required
            #priceInput="ngModel"
          >
          <div *ngIf="priceInput.invalid && priceInput.touched" class="error-message">
            El precio debe ser mayor a 0
          </div>
        </div>
        
        <div class="form-group">
          <label for="stock" class="form-label">Stock *</label>
          <input
            type="number"
            id="stock"
            name="stock"
            [(ngModel)]="formData.stock"
            class="form-input"
            placeholder="0"
            min="0"
            required
            #stockInput="ngModel"
          >
          <div *ngIf="stockInput.invalid && stockInput.touched" class="error-message">
            El stock debe ser mayor o igual a 0
          </div>
        </div>
      </div>
      
      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>
    </form>
    
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="closeModal()">
        Cancelar
      </button>
      <button 
        type="button" 
        class="btn btn-primary" 
        (click)="onSubmit()"
        [disabled]="productForm.invalid || isLoading"
      >
        <span *ngIf="!isLoading">{{ isEditMode ? 'Actualizar' : 'Crear' }}</span>
        <span *ngIf="isLoading">Procesando...</span>
      </button>
    </div>
  </div>
</div>
